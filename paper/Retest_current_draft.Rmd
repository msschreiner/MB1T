---
title             : "Limited evidence of test-retest reliability in infant-directed speech preference in a large pre-registered infant sample"
shorttitle        : "test-retest reliability of infant-directed speech preference"

author: 
  - name          : "Melanie S. Schreiner"
    affiliation   : "1,2"
    corresponding : yes    # Define only one corresponding author
    address       : "Gosslerstr. 14, 37073 Göttingen"
    email         : "melanie.schreiner@psych.uni-goettingen.de"
  - name          : "Christina Bergmann"
    affiliation   : "3"
  - name          : "Michael C. Frank"
    affiliation   : "4"
  - name          : "Tom	Fritzsche"
    affiliation   : "5"
  - name          : "Nayeli	Gonzalez-Gomez"
    affiliation   : "6" 
  - name          : "Kiley	Hamlin"
    affiliation   : "7"
  - name          : "Natalia	Kartushina"
    affiliation   : "8"
  - name          : "Danielle J.	Kellier"
    affiliation   : "4"
  - name          : "Nivedita	Mani"
    affiliation   : "1"
  - name          : "Julien	Mayor"
    affiliation   : "8"
  - name          : "Jenny	Saffran"
    affiliation   : "9"
  - name          : "Melanie	Soderstrom"
    affiliation   : "10"
  - name          : "Mohinish	Shukla"
    affiliation   : "11"
  - name          : "Priya	Silverstein"
    affiliation   : "12,13"
  - name          : "Martin	Zettersten"
    affiliation   : "9,14"
  - name          : "Matthias	Lippold"
    affiliation   : "1"

affiliation:
  - id            : "1"
    institution   : "University of Goettingen"
  - id            : "2"
    institution   : "Leibniz Science Campus PrimateCognition"
  - id            : "3"
    institution   : "Max Planck Insitute for Psycholinguistics"
  - id            : "4"
    institution   : "Stanford University"
  - id            : "5"
    institution   : "University of Potsdam"
  - id            : "6"
    institution   : "Oxford Brookes University"
  - id            : "7"
    institution   : "University of British Columbia"  
  - id            : "8"
    institution   : "University of Oslo"
  - id            : "9"
    institution   : "University of Wisconsin-Madison"
  - id            : "10"
    institution   : "University of Manitoba"
  - id            : "11"
    institution   : "Università di Padova"
  - id            : "12"
    institution   : "Lancaster University"
  - id            : "13"
    institution   : "Center for Open Science"
  - id            : "14"
    institution   : "Princeton University"
    
authornote: |
  **Acknowledgements.** This work was supported in part by Leibniz ScienceCampus Primate Cognition seed funds awarded to MS and ML, and grants from XXXX awarded to XXXX and from the NSF awarded to MZ (NSF DGE-1747503). 
  
  **Open Practices Statement.** All code for reproducing the paper is available at https://github.com/msschreiner/MB1T. Data and materials are available on OSF (https://osf.io/zeqka/).
  
  **CRediT author statement.** Outside of the position of the first and the last author, authorship position was determined by sorting authors' last names alphabetical order. An overview of authorship contributions following the CRediT taxonomy can be viewed here: https://docs.google.com/spreadsheets/d/1jDvb0xL1U6YbXrpPZ1UyfyQ7yYK9aXo002UaArqy35U/edit?usp=sharing.


abstract: |
 Test-retest reliability --- establishing that measurements remain consistent across multiple testing sessions --- is critical to measuring, understanding, and predicting individual differences in infant language development. However, previous attempts to establish measurement reliability in infant speech perception tasks are limited, and reliability of frequently-used infant measures is largely unknown. The current study investigated the test-retest reliability infant speech preference in a large sample (N=158) in the context of the ManyBabies1 collaborative research project (hereafter, MB1; Frank et al., 2017; ManyBabies Consortium, 2020) of infant-directed speech preference (hereafter, IDS) over adult-directed speech (hereafter, ADS; Cooper & Aslin, 1990). Labs of the original MB1 study were asked to bring in participating infants for a second appointment retesting infants on their IDS preference. This approach allows us to estimate test-retest reliability across three different methods used to investigate preferential listening in infancy: the head-turn preference procedure, central fixation, and eye-tracking. Overall, we find no consistent evidence of test-retest reliability in measures of infants' speech preference (overall *r* = .09, 95% CI [-.06,.25]). While increasing the number of trials that infants needed to contribute for inclusion in the analysis revealed a numeric growth in test-retest reliability, it also considerably reduced the study's effective sample size.  Therefore, future research on infant development should take into account that not all experimental measures might be appropriate to assess individual differences between infants, and hence, the interpretation of findings needs to be treated with caution.
  
  
keywords          : "language acquisition; speech perception; infant-directed speech; adult-directed speech; test-retest reliability"
wordcount         : "3977"

bibliography      : ["r-references.bib"]

figsintext        : yes
floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no

documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_pdf
---

```{r setup, include = FALSE}
library(papaja)
library(dplyr)
library(tidyr)
library(readxl)
library(lme4)
library(readr)
library(langcog)
library(ggthemes)
library(tidyverse)
library(here)
library(knitr)
library(kableExtra)
library("langcog")
library(lmerTest)
library(metafor)
library(magick)

write_path <- here("data","processed")
```

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
```

Obtaining a quantitative measure of infants' cognitive abilities is an extraordinarily difficult endeavor. 
The most frequent way to assess what infants know or prefer is to track overt behavior.
However, measuring overt behavior at early ages presents many challenges: participants' attention span is short, they do not follow instructions, their mood can change instantly and their behavior is often inconsistent. 
Therefore, most measurements are noisy and the typical sample size of an infant study is small (around 20 infants per group), resulting in low power [@oakes2017sample]. 
In addition, there is individual and environmental variation that may add even more noise to the data [e.g., @johnson2010using]. 
Despite these demanding conditions, reliable and robust methods for assessing infants’ behavior are critical to understanding development.

In order to address these challenges, the ManyBabies collaborative research consortium was formed to conduct large-scale, conceptual, consensus-based replications of seminal findings to identify sources of variability and establish best practices for experimental studies in infancy [@frank2017collaborative]. 
The first ManyBabies collaborative research project [hereafter, MB1, @manybabies2020quantifying] explored the reproducibility of the well-studied phenomenon that infants prefer infant-directed speech (hereafter, IDS) over adult-directed speech [hereafter, ADS, @cooper1990preference]. 
Across many different cultures, infants are commonly addressed in IDS, which typically is characterized by higher pitch, greater pitch range, and shorter utterances, compared to the language used between interacting adults [@fernald1989cross]. 
A large body of behavioral studies finds that infants show increased looking times when hearing IDS compared to ADS stimuli across ages and methods [@cooper1990preference; see @dunst2012preference for a meta-analysis]. 
This attentional enhancement is also documented in neurophysiological studies showing increased neural activation during IDS compared to ADS exposure [@naoi2012cerebral; @zangl2007increased]. 
IDS has also been identified as facilitating early word learning. 
In particular, infants’ word segmentation abilities [@floccia2016british; @schreiner2017listen; @singh2009influences, @thiessen2005infant] and their learning of word-object associations [@graf2013infant; @ma2011word] seem to be enhanced in the context of IDS. 
In sum, IDS seems to be beneficial for early language development.

Within MB1, 67 labs contributed data from 2,329 infants showing that babies generally prefer to listen to IDS over ADS. 
Nevertheless, the overall effect size *d* = 0.35 was smaller than a previously reported meta-analytic effect size of *d* = 0.67 [@dunst2012preference].
The results revealed several additional factors that influenced the effect size. 
First, older infants showed a larger preference of IDS over ADS. 
Second, the stimulus language was linked to IDS preference, with North American English learning infants showing a larger IDS preference than infants learning other languages.
Third, comparing the different methods employed, the head-turn preference procedure yielded the highest effect size, while the central fixation paradigm and eye-tracking methods revealed smaller effects.
Finally, exploratory analyses assessed the effect of different inclusion criteria. 
Across methods, using stricter inclusion criteria led to an increase in effect sizes despite the larger proportion of excluded participants [see also @byers2021six].

However, there is a difference between a result being reliable in a large sample of infants and the measurement of an individual infant being reliable. 
In studies tracking individual differences, the measured behavior during an experimental setting is often used to predict a cognitive function or specific skill later in life. 
Individual differences research of this kind often has substantial implications for theoretical and applied work.
For example, research showing that infants’ behavior in speech perception tasks can be linked to later language development [see @cristia2014predicting for a meta-analysis] has the potential to identify infants at risk for later language delays or disorders. 
However, a necessary precondition for this link to be observable is that individual differences between infants can be measured with high reliability at these earlier stages, in order to ensure that measured inter-individual variation mainly reflects differences in children's abilities rather than measurement error. 
How reliable are the measures used in infancy research?

Previous attempts to address the reliability of measurements are either limited to adult populations [@hedge2018reliability], or have been conducted with small sample sizes [e.g., @houston2007assessing].
For example, @colombo1988infant used a paired-comparison task, in which infants were familiarized with a stimulus and presented with the familiarized and a novel stimulus side-by-side at test. 
Results indicated that infants’ novelty preference was extremely variable from task to task. 
Assessing infants' performance from one week to another revealed that infants' attention measures were moderately reliable.
However, reliability seemed to increase with the number of tasks infants completed in the younger age group, suggesting that reliability is influenced by the number of assessments. 
In addition, infants' performance from 4 to 7 months was longitudinally stable but somewhat smaller than week-to-week reliability. 
@cristia2016test also retested infant populations by independently conducting 12 different experiments on infant speech perception at three different labs with different implementations of the individual studies. 
Hence, it was only after completed data collection that the data was pooled together by the different labs revealing potential confounds.
Nevertheless, the results showed that reliability was extremely variable across the different experiments and labs and low overall (meta-analytic *r* = .07).

Against this background, the current study investigates test-retest reliability of infants' performance in a speech preference task. 
Within MB1, a multi-lab collaboration, we examine whether infants' preferential listening behavior to IDS and ADS is reliable across two different test sessions. 
We also investigate the influence of various moderators on the reliability of IDS preference (e.g., time between test and retest; infants’ language background).

Our study was faced with a critical design choice: what stimulus to use to assess test-retest reliability. 
One constraint on our study was that, since it was a follow-on to MB1, any stimulus we used would always be presented after the MB1 stimuli. 
One option would be simply to bring back infants and have them hear exactly the same stimulus materials. 
A weakness of this design would be the potential for stimulus familiarity effects, however, since infants would have heard the materials before. 
Further complicating matters, infants might show a preference for or against a familiar stimulus depending on their age [@hunter1988multifactor]. 
The ideal solution then would be to create a brand new stimulus set with the same characteristics.
Unfortunately, because of the process of how MB1 stimuli were created, we did not have enough normed raw recordings available to make brand new stimulus items that conformed to the same standards as the MB1 stimuli.

We therefore chose an intermediate path: we reversed the ordering of MB1 stimuli.
Average looking times in MB1 were always lower than 9s per trial, even for the youngest children on the earliest trials (the group who looked the longest on average), so most children in MB1 did not hear the second half of most trials. 
Thus, by reversing the order, we had a perfectly matched stimulus set that was relatively unfamiliar to most infants.
The disadvantage of this design was that infants who looked longer might be more likely to hear a familiar clip heard in the previous study. 
If infants then showed a familiarity preference –-- an assumption which might not be true –-- the end result could be to inflate our estimates of test-retest reliability slightly, since longer lookers would on average look longer at retest due to their familiarity preference.
We view this risk as relatively low, but do note that it is a limitation of our design. 

The current study also explores whether there are any differences in test-retest reliability between three widely used methods: central fixation (CF), eye-tracking (ET), and the head-turn preference procedure (HPP).
Exploring differences in CF, eye-tracking, and HPP, @junge2020contrasting provide experimental and meta-analytic evidence in favor of using the HPP in speech segmentation tasks.
Similarly, the MB1 project reported an increase in the effect size for HPP compared to CF and eye-tracking [@manybabies2020quantifying].
HPP requires gross motor movements relative to other methods, such as CF and eye-tracking paradigms, for which subtle eye movements towards a monitor located in front of the child are sufficient.
One possible explanation for the stronger effects with HPP may be a higher sensitivity to the contingency of the presentation of auditory stimuli and infants’ head turns away from the typical forward-facing position.
While these findings suggest that HPP may be a more sensitive index of infant preference, they do not necessarily imply higher reliability for individual infants’ performance using these different methods. 
It remains an open question whether the same measures that produce larger effect sizes at the group-level also have higher test-retest reliability for individual infants [@byers2021six]. 
Therefore, assessing the test-retest reliability of the different preference measures is crucial, so that researchers can make informed decisions about the appropriate methods for their particular research question. 
Critically, only measures with high test-retest reliability should be used for studies of individual differences.



# Method

## Preregistration

Prior to the start of data collection, we preregistered the current study on the Open Science Framework (https://osf.io/v5f8t; see S1 in the Supplementary Materials for details). 

## Data Collection

A call was issued to all labs participating in the original MB1 study on January 24th, 2018 [@manybabies2020quantifying]. The collection of retest session data was initially set to end on May 31st, 2018, one month after the end date of the original MB1 project. Due to the fact that the original MB1 project extended the time frame for data collection and the late start of data collection for the MB1 test-retest study, we also allowed participating labs to continue data collection past the scheduled end date.

## Participants

```{r,message=FALSE,warning=FALSE}
# importing dataset
df_all <- read_csv(here("data","processed","df_all.csv"))

# Calculating the variable days between the two test sessions
df_all <- df_all %>% 
  group_by(Subject,Subject_Unique,Lab) %>% 
  mutate(days_between_sessions=max(Age)-min(Age)) %>%
  ungroup() 

# Truncating the looking times per trial at 18 seconds
# consistent with decision from MB1
df_all <- df_all %>% 
  mutate(LT=ifelse(LT>18,18,LT)) 


#### Processing exclusions ####
# Excluding all children with session errors
# Based on the preregistration, participants must meet the inclusion criteria for both test and retest sessions, so we exclude participants who have a session error during either test session
excludeID <- unique(df_all$Subject_Unique[df_all$session_error=="error"])

#tabulate session errors
df_all_exclude <- df_all %>% 
  filter(Subject_Unique %in% excludeID)

df_all_exclude_type <- df_all_exclude %>% filter(session_error=="error") %>%
  select(session_error_type) %>%
  distinct()

df_all_exclude_counts <- df_all_exclude %>%
  group_by(Subject_Unique,Session) %>%
  select(session_error,session_error_type) %>%
  distinct()

df_all <- df_all %>% 
  filter(!Subject_Unique %in% excludeID)

#not needed as there are no premies? Checking preterm babies from Priya
#exclude preterms
#excludePreterm<-unique(df_all$Subject[df_all$preterm=="preterm"])
#df_all<-df_all %>% filter(preterm!="preterm")

# exclude trials with trial error
df_all <- df_all %>% 
  filter(trial_error == "noerror")

#save data after removing exclusions
write_csv(df_all,here(write_path,"df_all_after_exclusions.csv"))

# number of labs
n_labs <- length(unique(df_all$Lab))
# number of excluded infants
n_exclude <- length(excludeID)
```

```{r,message=FALSE,warning=FALSE}
LT_MIN <- 2                # minumum LT for inclusion
MIN_TRIALS_PER_TYPE <- 1  # min trials per type for inclusion
LOOKING_MEASURE <- "raw" #how to compute aggregated looking time preferences per subject. raw = using raw (average) looking times. log = using log-transformed (average) looking times

# function for cleaning data 
# by using minimum LT for inclusion and minimum number of trials per condition,
# and removing training trials.
# also adding new columns: log-transformed looking data, number of looking trials below threshold
clean_data <- function(dataset, minimum_looking_time, minimum_trials_per_type, file_path) {
  data_clean <- dataset %>%
    #remove training trials
    filter(Condition != "training") %>%
    group_by(Subject, Subject_Unique,Session,Lab) %>%
    # log-transformation of LT
    mutate(log_lt = log(LT))  %>% 
    mutate(
      N_below_threshold_lt = sum(LT < minimum_looking_time)
      ) %>%
    #remove looking times below minimum looking time
    filter(LT >= minimum_looking_time) %>%
    #compute number of remaining trials of each type
    mutate(N_IDS = sum(Condition == "IDS"),
           N_ADS = sum(Condition == "ADS"),
           total_trial_n = N_IDS + N_ADS) %>%
    #remove rows where the number of IDS or ADS trials is below the minimum number of required trials
    filter(N_IDS >= minimum_trials_per_type & 
           N_ADS >= minimum_trials_per_type)
  
  #write the resulting data file
  write_csv(data_clean, file_path)
  
  return(data_clean)
}

#clean data based on minimum looking time and number of minimum trials
data_clean <- clean_data(df_all,
                         minimum_looking_time=LT_MIN,
                         minimum_trials_per_type=MIN_TRIALS_PER_TYPE,
                         file_path=here(write_path,"clean_data_minimum_trials_per_type_1.csv"))

# function for aggregating LT and log_lt for each Subject, Session and Condition
aggregate_by_subject <- function(cleaned_data, file_path) {
  agg_subjects <- cleaned_data %>%
    group_by(Lab, Method, Subject, Subject_Unique,Language, Condition, Age,Session,total_trial_n) %>%
    summarise(mean_log_lt = mean(log_lt),
              mean_lt = mean(LT)) %>%
    mutate(ConditionC = ifelse(Condition == "IDS", .5, -.5)) %>%
    mutate(language_recoded = case_when(
      Lab %in% c("InfantCog-UBC","infantll-madison") & Language == "English" ~ "American English",
      TRUE ~ Language
      )) %>%
    mutate(Native = ifelse(language_recoded == "American English", TRUE, FALSE))
  
  #write the resulting data file
  write_csv(agg_subjects, file_path)
  
  return(agg_subjects)
}

#aggregate data by-participant
agg_subjects <- aggregate_by_subject(data_clean,file_path=here(write_path,"agg_subjects_minimum_trials_per_type_1.csv"))

#summarize looking time across subjects
# calculating mean lt in seconds for Session and Condition
agg_subjects_lt <- agg_subjects %>%
  group_by(Condition, Session) %>%
  summarise(MeanLT = mean(mean_lt),
            SD_LT = sd(mean_lt)) %>%
  pivot_wider(names_from=Session,values_from=c(MeanLT, SD_LT),names_prefix="session_") %>%
  relocate(SD_LT_session_1, .before = MeanLT_session_2)

# function for creating a wide format of the dataset and calculating difference in lt and log_lt for IDS and ADS and the proportion of IDS looking
aggregate_by_subject_paired <- function(aggregated_subjects, file_path) {
  
  all_agg_subjects_paired <- aggregated_subjects %>%
    select(-ConditionC) %>%
    pivot_wider(names_from = Condition, values_from = c(mean_lt,mean_log_lt)) %>%
    rename(IDS = mean_lt_IDS,ADS = mean_lt_ADS) %>%
    mutate(Diff = IDS - ADS,
           Prop = IDS / (IDS + ADS),
           binary_pref = case_when(
             is.na(Diff) ~ NA_character_,
             Diff > 0 ~ "IDS_preference",
             Diff < 0 ~ "ADS_preference",
             Diff == 0 ~ "no_preference"
             ),
           Diff_log_lt = mean_log_lt_IDS - mean_log_lt_ADS,
           Prop_log_lt = mean_log_lt_IDS / (mean_log_lt_IDS+mean_log_lt_ADS)
           )
  
  tally_subject_sessions <- all_agg_subjects_paired %>%
    select(Subject_Unique,Diff) %>%
    group_by(Subject_Unique) %>%
    tally() 
  
  #remove subjects with less than 2 sessions
  subjects_to_remove <- tally_subject_sessions %>%
    filter(n<2) %>%
    pull(Subject_Unique)
  all_agg_subjects_paired <- all_agg_subjects_paired %>%
    filter(!(Subject_Unique %in% subjects_to_remove))
  
  #write data
  write_csv(all_agg_subjects_paired, file_path)
  
  return(all_agg_subjects_paired)
}

#create wide format summarizing data per participant
all_agg_subjects_paired <- aggregate_by_subject_paired(agg_subjects, file_path=here(write_path,"all_agg_subjects_paired_minimum_trials_per_type_1.csv"))

# function for creating a wide format of the dataset such that the difference scores for each Session become a separate variable, calculating the number of days between test and retest session, and mean Age for both testing sessions
aggregate_by_subject_paired_retest <- function(aggregated_subjects_paired, file_path) {
  
  all_agg_subjects_paired_retest <- aggregated_subjects_paired %>%
    group_by(Lab,Subject,Subject_Unique,Method,Language, language_recoded, Native) %>%
  pivot_wider(names_from=Session,values_from=c(Age,total_trial_n,IDS,ADS,Diff,Prop,binary_pref,mean_log_lt_IDS,mean_log_lt_ADS,Diff_log_lt,Prop_log_lt),names_prefix="session_") %>% 
  mutate(days_between_sessions=Age_session_2-Age_session_1,
         Age = rowMeans(cbind(Age_session_2,Age_session_1),na.rm=TRUE)) %>%
  rename(Diff_1 = Diff_session_1, Diff_2 = Diff_session_2)
  
  #write data
  write_csv(all_agg_subjects_paired_retest, file_path)
  
  return(all_agg_subjects_paired_retest)
}

#create wide format summarizing differences scores by session per participant
all_agg_subjects_paired_retest <- aggregate_by_subject_paired_retest(all_agg_subjects_paired,file_path=here(write_path,"all_agg_subjects_paired_retest_minimum_trials_per_type_1.csv"))

# Getting the number of final participants
n <- length(unique(all_agg_subjects_paired$Subject_Unique)) # Final sample of participants
n_exclude_session <- length(unique(df_all$Subject_Unique))-n # Calculating Participants lost due to missing valid trial in either session 1 or session 2

# mean, minimum, and maximum age across both testing sessions
age_stats <- all_agg_subjects_paired_retest %>% 
  ungroup() %>%
  select(Age) %>% 
  summarise_at(vars(Age),funs(mean,min,max))

# Stats on number of days between test and retest
stats_daysbetween <- all_agg_subjects_paired_retest %>% 
  ungroup() %>% 
  select(days_between_sessions) %>% 
  summarise_at(vars(days_between_sessions),funs(mean,min,max))
```

Contributing labs were asked to re-recruit their monolingual participants between the ages of 6 to 12 months who had already participated in the MB1 project. 
If participating labs had not committed to testing either of these age groups, they were also allowed to re-recruit participants from the youngest age group of 3- to 6-month-olds and/or the oldest age group of 12- to 15-month-olds. 
Labs were asked to contribute half (*n*=16) or full samples (*n*=32); however, a lab's data was included in the study regardless of the number of included infants. 
The study was approved by each lab's respective ethics committee and parental consent was obtained for each infant prior to participation in the study.

Our final sample consisted of `r n` monolingual infants from `r n_labs` different labs (Table 1). 
In order to be included in the study, infants needed a minimum of 90% first language exposure, to be born full term with no known developmental disorders, and normal hearing and vision. 
We excluded `r n_exclude` participants due to session errors and `r n_exclude_session` participants who did not have at least one valid trial per condition (IDS and ADS) at their first or second session. 
The mean age of infants included in the study was `r round(age_stats$mean, 0)` days (range: `r age_stats$min` -- `r age_stats$max` days).

## Materials

### Visual stimuli.
The visual stimuli and instructions were identical to MB1.
For the central fixation paradigm and eye-tracking, labs used a multicolored static checkerboard as the fixation stimulus as well as a multicolored moving circle with a ringing sound as an attention-getter between trials.
For the HPP method, labs used their standard procedure, as in MB1.

### Speech stimuli.
We used the identical training stimuli of piano music from MB1.
A second set of naturalistic IDS and ADS recordings of mothers either talking to their infant or to an experimenter was created for the retest session by reversing the order of clips within each sequence of the original study
This resulted in eight new sequences of natural IDS and eight new sequences of natural ADS with a length of 18 seconds each.
 
### Procedure.
Infants were retested using the identical procedure as during the first testing day: central fixation, HPP, or eye-tracking. 
Participating labs were asked to schedule test and retest sessions 7 days apart with a minimum number of 1 day and a maximum number of 31 days. 
However, infants whose time between test and retest exceeded 31 days were still included in the analyses (*n* = 3). 
The mean number of days between test and retest was `r round(stats_daysbetween$mean, 1)` (range: `r stats_daysbetween$min` - `r stats_daysbetween$max`).

A total of 18 trials, including two training, eight IDS, and eight ADS trials, were presented in one of four pseudo-randomized orders. 
Trial length was either infant-controlled or fixed depending on the lab’s standard procedure: a trial stopped either if the infant looked away for 2 seconds or after the total trial duration of 18 seconds. 
The online coding experimenter and the parent listened to music masked with the stimuli of the study via noise-cancelling headphones. 
If the experimenter was in an adjacent room separate from the testing location, listening to masking music was optional for the experimenter.
 
### Data exclusion.
A child was excluded if they had a session error, i.e., an experimenter error (e.g., inaccurate coding, or presentation of retest stimuli on the first test session) or equipment failure (visual stimuli continued to play after the end of a trial). 
Trials were excluded if they were marked as trial errors, i.e., if the infant was reported as fussy, an experimental or equipment error occurred, or there was parental interference during the task (e.g., if the parent spoke with the infant during the trial).
Trials were also excluded if the minimum looking time of 2 s was not met. 
If a participant was unable to contribute at least one IDS and one ADS trial for either test or retest, all data of that participant was excluded from the test-retest analyses.

# Results

```{r labs, results="asis", message=FALSE, warning=FALSE}

# Summarize mean Age and number of Subjects for each lab, method, and language
lab_stats<-all_agg_subjects_paired_retest %>% select(Lab,Subject,Method,Age,Language) %>% group_by(Lab,Method,Language) %>% 
  summarise(Age=mean(Age),N=length(unique(Subject)))

# Assign column label to column 4
names(lab_stats)[4]<-"Mean age (days)"

# Create data set that includes language variable from main data set
#df_all_Language<-df_all %>% select(Lab,Method,Language) %>% group_by(Lab) %>% 
  #summarise(Method=as.character(unique(Method)[1]),Language=unique(Language[1]))

# Merge with lab stats
#lab_stats<-left_join(lab_stats,df_all_Language)

#slight edit to method naming
lab_stats <- lab_stats %>%
  mutate(Method = case_when(
    Method=="Eyetracking" ~ "eye-tracking",
    TRUE ~ Method
  ))

papaja::apa_table(lab_stats, 
                  caption = "Statistics of the included labs. n refers to the number of infants included in the final analysis.", 
                  format.args = list(digits = 0))

```

## IDS preference

```{r,message=FALSE,warning=FALSE}
# Linear mixed model assessing if session predicts differences in LT 
diff_session_1 <- lmer(Diff ~ Session + 
                (1 | Lab) + (1 | Subject), 
              data=all_agg_subjects_paired, REML=FALSE)

diff_session_2 <- lmer(Diff ~ Session + (1+Session|Lab) + (1|Subject),
                       data=all_agg_subjects_paired, REML=FALSE)
#this model yields a singular boundary fit but also yields similar results to the first model 

diff_session_coefs<-summary(diff_session_1)$coefficients
diff_session_coefs2<-summary(diff_session_2)$coefficients


# Subsetting to session 1 for t-test
all_agg_subjects_paired_s1 <- subset(all_agg_subjects_paired, all_agg_subjects_paired$Session=="1")

ttestSession1<-t.test(all_agg_subjects_paired_s1$Diff)

# Subsetting to session 2 for t-test

all_agg_subjects_paired_s2 <- subset(all_agg_subjects_paired, all_agg_subjects_paired$Session=="2")

ttestSession2 <- t.test(all_agg_subjects_paired_s2$Diff)

```

First, we examined infants' preference for IDS in both sessions. Two-samples t-tests comparing the difference in average looking time between IDS and ADS to zero revealed that infants showed a preference of IDS over ADS in Session 1 (`r apa_print(ttestSession1)$statistic`) and Session 2 (`r apa_print(ttestSession2)$statistic`), replicating the main finding from MB1 (Table 2).
`r sum(all_agg_subjects_paired_s1$Diff>0)/length(all_agg_subjects_paired_s1$Diff)*100`% of infants in Session 1 and `r sum(all_agg_subjects_paired_s2$Diff>0)/length(all_agg_subjects_paired_s2$Diff)*100`% of infants in Session 2 showed a preference for IDS.
In order to test whether there was a difference in the strength of the preference effect across sessions, we fit a linear mixed-effects model predicting infants' average difference in looking time between IDS and ADS from test session (1 vs. 2), including by-lab and by-participant random intercepts.
There was no significant difference in the magnitude of infants’ preference between the two sessions, $\beta$=`r round(diff_session_coefs[2,1],2)`, *SE*=`r round(diff_session_coefs[2,2],2)`, *p*=`r printp(diff_session_coefs[2,5])`.

```{r descriptives_table1, results="asis",warning=FALSE,message=FALSE}

papaja::apa_table(agg_subjects_lt, 
                  caption = "Average looking times (in seconds) for each session and condition", 
                  format.args = list(digits = 2),
                  col.names=c("Trial type", "Session 1 Mean","Session 1 $SD$","Session 2 Mean", "Session 2 $SD$"))
```

## Reliability

```{r coef_table2, results="asis",warning=FALSE,message=FALSE}
# Linear mixed model predicting difference score of session 2 from difference score of session 1
mod_lmer <- lmer(Diff_2 ~ Diff_1 + (1|Lab),
              data=all_agg_subjects_paired_retest,REML=T)

#secondary preregistered model
# including an additional by-lab random slope for test session 1
# this model yields qualitatively equivalent results
mod_lmer_b <- lmer(Diff_2 ~ Diff_1 + (1+Diff_1|Lab),
              data=all_agg_subjects_paired_retest,REML=T)

# Coefficients for linear mixed model predicting difference score of session 2 from difference score of session 1
coefs <- summary(mod_lmer)$coef %>%
  as_data_frame %>%
  mutate_at(c("Estimate","Std. Error","df", "t value", "Pr(>|t|)"), 
            function (x) signif(x, digits = 3)) %>%
  rename(SE = `Std. Error`, 
         t = `t value`,
         p = `Pr(>|t|)`) %>%
  select(-df)
         
rownames(coefs) <- c("Intercept", "IDS Preference Session 1")

papaja::apa_table(coefs, 
                  caption = "Coefficient estimates from a linear mixed effects model predicting IDS preference in Session 2.", 
                  format.args = list(digits = 2))

# Preference Reversal
reversal <- all_agg_subjects_paired %>%
  select(Subject_Unique, Session, binary_pref)

reversal <- reversal[,c(2, 6:8)]

reversal <- reversal %>%
  group_by(Subject_Unique) %>%
  pivot_wider(names_from = Session, values_from = binary_pref)

names(reversal) <- c("Method", "Subject_Unique","Pref_Test" , "Pref_Retest")
  
reversal <- reversal %>%
  group_by(Subject_Unique) %>%
  mutate(reversal = case_when((Pref_Test == "IDS_preference" & Pref_Retest == "IDS_preference")  ~ 0,
                              (Pref_Test == "ADS_preference" & Pref_Retest == "ADS_preference")  ~ 0,
                              (Pref_Test == "IDS_preference" & Pref_Retest == "ADS_preference")  ~ 1,
                              (Pref_Test == "ADS_preference" & Pref_Retest == "IDS_preference")  ~ 1))

n_reversal <- length(reversal$reversal[reversal$reversal==1])
n_total <- length(reversal$reversal)

perc_reversal <- n_reversal/n_total*100

reversal$reversal <- as.factor(reversal$reversal)

# Figure for reversal (not shown)

reversal_plot <- left_join(all_agg_subjects_paired_retest, reversal)

reversal_plot$Diff <- reversal_plot$Diff_1 - reversal_plot$Diff_2

rev_plot <- ggplot(reversal_plot, aes(y=reversal_plot$Diff, x=reversal, fill=reversal))+
  geom_boxplot()+
  stat_summary(fun.y=mean, geom="point", shape=20, size=10, color="green", fill="green") +
  geom_jitter()

#t.test(reversal_plot$Diff[reversal_plot$reversal==0],reversal_plot$Diff[reversal_plot$reversal==1])

```

```{r}
# calculate simple correlation of difference score of session 1 and difference score of session 2
simplyOverallCorr<-cor.test(all_agg_subjects_paired_retest$Diff_1,
         all_agg_subjects_paired_retest$Diff_2)
```

```{r fig.cap="Correlation between IDS Preference in Session 1 and Session 2 in each lab and method. Dots indicate individual participants. Error bands represent +1/-1 SEs. The dashed line indicates no preference (i.e., a value of zero) for the first and second session, respectively.", fig.align="center"}

all_agg_subjects_paired_retest <- all_agg_subjects_paired_retest  %>%
  mutate(
    Method=case_when(
      Method=="Eyetracking" ~ "ET",
      Method=="central fixation" ~ "CF",
      TRUE ~ Method
    )
  ) %>%
  unite(lab_method,Lab,Method,sep=", ", remove=FALSE)

ggplot(all_agg_subjects_paired_retest,aes(Diff_1,Diff_2))+
  geom_vline(xintercept=0,linetype="dashed")+
  geom_hline(yintercept=0,linetype="dashed")+
  geom_point()+
  geom_smooth(method="lm")+
  xlab("IDS preference in first session")+
  ylab("IDS preference in second session")+
  facet_wrap(~lab_method,ncol=4)+
  theme(panel.background = element_rect(fill = "white",
                                colour = "black",
                                size = 0.5, linetype = "solid"),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  strip.background = element_blank())
```

We assessed test-retest reliability in two ways. 
First, we fit a linear mixed-effects model predicting IDS preference in Session 2 from IDS preference in Session 1, including a by-lab random intercept. 
The results revealed no significant relationship between IDS preference in Session 1 and 2 (Table 3). 
Second, we calculated the Pearson correlation coefficient. 
While a simple correlation coefficient might overestimate the test-retest reliability in our sample because it does not control for the differences between different labs and methods (HPP, CF, and eye-tracking), we felt it was important to also conduct a Pearson correlation as it is commonly used to assess reliability. 
The size of the correlation coefficient was not statistically different from zero and the estimate was small, `r apa_print(simplyOverallCorr)$full_result`. 
Moreover, no significant correlations emerged in each sample considered separately (Figure 1; see Supplementary Materials S3 for a meta-analytic approach).
 `r perc_reversal` percent of the infants reversed their direction of preference for IDS versus ADS from the test to the retest session. 

```{r results="asis",warning=FALSE,message=FALSE}
#function for computing coefficient table from lmer model and correlation reliability
compute_coefs_reliability <- function(dataset) {
  #fit lmer reliability model
  mod_lmer <- lmer(Diff_2 ~ Diff_1 + (1|Lab),data=dataset,REML=T)
  #extract coefficients
  coef <- summary(mod_lmer)$coef %>%
    as_data_frame %>%
    mutate_at(c("Estimate","Std. Error","df", "t value", "Pr(>|t|)"), 
              function (x) signif(x, digits = 3)) %>%
    rename(SE = `Std. Error`, 
           t = `t value`,
           pvalue = `Pr(>|t|)`,
           estimate = Estimate) %>%
    #keep just main coefficient estimate
    slice(2) %>%
    #keep most important columns
    select(estimate, SE, pvalue)
  
  #compute correlation and add to summarized data
  correlation<-cor.test(dataset$Diff_1,dataset$Diff_2) 
  summarized_data <- coef %>%
    mutate(cor=as.numeric(correlation$estimate),
           pvalue2=as.numeric(correlation$p.value))
  
  #return
  summarized_data
}
coef_table <- all_agg_subjects_paired_retest %>%
  group_by(Method) %>%
  nest() %>%
  #compute coefficients
  mutate(coef_table = purrr::map(data, compute_coefs_reliability)) %>%
  #remove data
  select(-data) %>%
  #unpack
  unnest(cols=c(coef_table)) %>%
  select(-pvalue2) %>%
  mutate(
    Method=case_when(
      Method=="Eyetracking" ~ "eye-tracking",
      Method=="central fixation" ~ "central fixation",
      TRUE ~ Method
    )
  )
  
papaja::apa_table(coef_table, 
                  caption = "Coefficient estimates from a linear mixed effects model predicting IDS preference in Session 2 and Pearson correlation coefficient for each method separately.", 
                  col.names = c("Method","beta","SE","p","Pearson r"),
                  format.args = list(digits = 2))
```

To investigate the test-retest reliability of each specific method, we computed Pearson correlation coefficients and the same mixed-effects model described above for HPP, central fixation and eye-tracking separately (Table 4). 
None of the three methods showed evidence of test-retest reliability. 
Neither the Pearson correlation coefficients nor the coefficients of the multilevel analysis were significant, all *p*s > `r floor(min(coef_table$pvalue)*100)*0.01`.
In planned secondary analyses, we found that time between test sessions, participant age, and language background did not moderate the relationship between IDS preference in session 1 and session 2 (Supplementary Materials, S2).
Taken together, we find no significant evidence of test-retest reliability across our preregistered analyses.

## Results with different inclusion criteria

```{r,message=FALSE,warning=FALSE}

#helper function to combine all aggregation steps, with minimum number of trial pairs exclusion criterion applied
aggregate_complete <- function(dataset,min_trials) {
  
  cur_agg_subjects_paired_retest <- dataset %>%
    clean_data(minimum_looking_time=LT_MIN,minimum_trials_per_type=min_trials,file_path=here(write_path,paste0("clean_data_minimum_trials_per_type_",min_trials,".csv"))) %>%
    aggregate_by_subject(file_path=here(write_path,paste0("agg_subjects_minimum_trials_per_type_",min_trials,".csv"))) %>%
    aggregate_by_subject_paired(file_path=here(write_path,paste0("all_agg_subjects_paired_minimum_trials_per_type_",min_trials,".csv"))) %>%
    aggregate_by_subject_paired_retest(file_path=here(write_path,paste0("all_agg_subjects_paired_retest_minimum_trials_per_type_",min_trials,".csv")))
  
  return(cur_agg_subjects_paired_retest)
}

# Creating data sets for different number of minimum trial pairs included: 1, 2, 4, 6, and 8
min_trials<-c(1,2,4,6,8)

# create paired retest dataframes for each participant inclusion level based on the minimum number of trial pairs
paired_retest_df_by_trial_exclusions <- df_all %>%
  #expand and then nest data frame for each level of minimum trial pairs
  expand_grid(min_trials=min_trials) %>%
  group_by(min_trials) %>%
  nest() %>%
  #now aggregate data for each minimum trial exclusion level
  mutate(
    all_agg_subjects_paired_retest = purrr::map2(data,min_trials,aggregate_complete)
  ) %>%
  select(-data)

##### functions for computing and printing test-retest correlation
create_exclusion_dataset <- function(df, minimum_trials=1) {
  #create the dataset based on the minimum trial inclusion criterion
  filtered_data <- df %>%
    filter(min_trials==minimum_trials) %>%
    unnest(cols = c(all_agg_subjects_paired_retest))
  return(filtered_data)
}

compute_test_retest_correlation <- function(dataset,session_1_column="Diff_1",session_2_column="Diff_2") {
  #compute the test-retest correlation
  correlation <- cor.test(dataset[[session_1_column]],dataset[[session_2_column]])
  correlation
}

#compute correlations for various inclusion criteria
correlation_1 <- create_exclusion_dataset(paired_retest_df_by_trial_exclusions,minimum_trials=1) %>%
  compute_test_retest_correlation()
correlation_2 <- create_exclusion_dataset(paired_retest_df_by_trial_exclusions,minimum_trials=2) %>%
  compute_test_retest_correlation()
correlation_4 <- create_exclusion_dataset(paired_retest_df_by_trial_exclusions,minimum_trials=4) %>%
  compute_test_retest_correlation()
correlation_6 <- create_exclusion_dataset(paired_retest_df_by_trial_exclusions,minimum_trials=6) %>%
  compute_test_retest_correlation()
correlation_8 <- create_exclusion_dataset(paired_retest_df_by_trial_exclusions,minimum_trials=8) %>%
  compute_test_retest_correlation()
correlations <- c(correlation_1$estimate,correlation_2$estimate,correlation_4$estimate,correlation_6$estimate,correlation_8$estimate)
```

To this point, all analyses were performed using the inclusion criteria from MB1, which required only that infants contribute at least 1 trial per condition for inclusion (i.e., one IDS and one ADS trial). 
However, more stringent inclusion criteria yielded larger effect sizes in MB1. 
We therefore conducted exploratory analyses assessing test-retest reliability after applying progressively stricter inclusion criteria, requiring 2, 4, 6, and 8 valid trials per condition. 
Applying stricter criteria --- and thereby increasing the number of test trials --- increased reliability numerically from r = `r round(min(correlations),2)` to r = `r round(max(correlations),2)` (Figure 2). 
In part due to a decrease in sample size, only one of these correlations was statistically significant (when requiring 6 trial pairs): 2 valid trial pairs, `r apa_print(correlation_2)$statistic`; 4 valid trial pairs, `r apa_print(correlation_4)$statistic`; 6 valid trial pairs, `r apa_print(correlation_6)$statistic`; 8 valid trial pairs --- all trials in both sessions --- `r apa_print(correlation_8)$statistic`. 
The analyses provide tentative evidence that stricter inclusion criteria may lead to higher test-retest reliability, but at the cost of substantial decreases in sample size.

```{r fig.cap="IDS preferences of both sessions plotted against each other for each inclusion criterion. n indicates the number of included infants, r is the Pearson correlation coefficient as the indicator for reliability.", fig.align="center",out.width = "5in",fig.height = 10, fig.width = 8}

# Creating scatterplot for each inclusion criterion
plot_exclusion_dataset <- function(current_dataset,minimum_trials=1,
                                   Limaxes=c(-4,10),
                                   session_1_column="Diff_1",
                                   session_2_column="Diff_2",
                                   xlab = "IDS preference in first session",
                                   ylab = "IDS preference in second session"
                                   ) {
  current_correlation <- cor.test(current_dataset[[session_1_column]],current_dataset[[session_2_column]])
  main_message <- paste0("Inclusion criterion: ",minimum_trials," trial pairs")
  plot(current_dataset[[session_1_column]],current_dataset[[session_2_column]],xlab = xlab,ylab=ylab,main = main_message,xlim = Limaxes,ylim = Limaxes)
abline(lm(current_dataset[[session_2_column]]~current_dataset[[session_1_column]]),col="red")
legend("topleft",legend = paste("r = ",round(current_correlation$estimate,2),"; n = ",current_correlation$parameter+2,sep=""))
}

par(mfrow = c(2, 2))
plot_exclusion_dataset(create_exclusion_dataset(paired_retest_df_by_trial_exclusions,minimum_trials=2),minimum_trials=2)
plot_exclusion_dataset(create_exclusion_dataset(paired_retest_df_by_trial_exclusions,minimum_trials=4),minimum_trials=4)
plot_exclusion_dataset(create_exclusion_dataset(paired_retest_df_by_trial_exclusions,minimum_trials=6),minimum_trials=6)
plot_exclusion_dataset(create_exclusion_dataset(paired_retest_df_by_trial_exclusions,minimum_trials=8),minimum_trials=8)
```

# General Discussion

The current study investigated the test-retest reliability of infants' preference for IDS over ADS. 
We retested the IDS preference of infants participating in the original MB1 project to assess the extent to which their pattern of preference would remain consistent across multiple testing sessions. 
While we replicated the original effect of infants’ speech preference for IDS over ADS for both test and retest session on the group-level, we found that infants' speech preference measures showed no evidence of test-retest reliability. 
In other words, we were unable to detect stable individual differences in infants' preference for IDS. 
This finding is consistent with past research suggesting low test-retest reliability in other infant paradigms [@cristia2016test]. 
Given that most experimental procedures conducted in infant research are interested in the comparison of groups, individual differences between participants within a specific condition are usually minimized by the experimental procedure while differences between conditions are maximized. 
Therefore, infant preference measures may be a good approach for capturing group-level phenomena, but may be less appropriate for examining individual differences in development.

Consistent with general psychometric theory [e.g.,@debolt2020robust], stricter inclusion criteria --- and consequently a larger number of included test trials per participant --- tended to increase the magnitude of the correlation between test sessions. 
However, this association was based on exploratory analyses and was only observed descriptively, and hence should be interpreted with caution. 
A similar effect on the group-level was found in the MB1 project, where a stricter inclusion criterion led to bigger effect sizes [@manybabies2020quantifying]. 
As in MB1, higher reliability through strict exclusions came at a high cost. 
In particular, with the strictest criterion, only a small portion of the original sample size (24 out of 158 infants) could be included in the final sample.
In other words, applying stricter criteria leads to a higher drop-out rate and can dramatically reduce sample size. 
In the case of studies in the field of developmental science, where there are many practical restrictions in collecting large samples of infants (e.g., birth rate in the area, restricted lab capacities, budget restrictions), a strict drop-out criterion may often be difficult --- if even possible at all --- to implement. 
Note that studies in developmental science already have above-average drop-out rates [@miller2017developmental]. 
In addition, drop out may not be random, and so having high drop-out rates can further limit the generalizability of a study. 
In fact, the number of trials individual infants contributed was highly correlated between test sessions in the current study (*r* = 0.58, see S6 in the Supplementary Materials).
Particularly in the context of turning individual differences measures into diagnostic tools, high drop-out rates have an additional limitation of not being broadly usable.

An alternative approach to increasing the number of valid trials is to increase the number of experimental trials. 
This approach seeks to increase the likelihood that participants will contribute sufficient trials (after trial-level exclusions) to allow for precise individual-level estimates [@debolt2020robust; see also @silverstein2021infants]. 
While this approach is promising, it may not always be feasible, because the attention span of a typical infant participant is limited. 
Therefore, prolonging the experimental procedure to maximize the absolute number of trials is often challenging in practice. 
Other avenues for obtaining higher numbers of valid trials may include changes in the procedure [e.g., @egger2020improving] or implementing multi-day test sessions [@fernald2012individual].

As our results are only based on the phenomenon of IDS preference (albeit, with three widely used methods: HPP, central fixation; eye-tracking) it is essential to further assess the underlying reliability of preferential looking measures within other areas of speech perception. 
While most infants prefer IDS over ADS [@dunst2012preference], patterns of preferential looking in other tasks (e.g., speech segmentation) are often inconsistent and difficult to predict [@bergmann2016development].
These inconsistencies in looking behavior are especially important to consider in the context of relating a direction of preference to later language development, and can sometimes lead to seemingly contradictory findings. 
That is, both familiarity and novelty responses have been suggested to be predictive of infants’ later linguistic abilities [@depaolis2014infants; @newman2006infants; @newman2016input].
In light of our findings, researchers conducting longitudinal studies with experimental data from young infants predicting future outcomes should be cautious, as there may be large intra-individual variability affecting preference measurement.

## Limitations
While we had an above-average sample size for a study in infant research, we were unable to approach the number of participants collected within the original MB1 study. 
In addition to a delayed call, the extra effort of having to schedule a second lab visit for each participant and the fact that there were already other collaborative studies taking place simultaneously [MB1B, @byers2021multilab; MB1G, @byers2021development], might have contributed to a low participation rate.
A higher sample size and a larger number of participating labs from different countries would have enabled us to conduct a more highly-powered test of differences in test-retest reliability across different methods, language backgrounds, and participant age.

A further limitation concerns the stimuli. While the order of the audio recording clips presented to infants within a given trial differed between the first and second session, the exact same stimulus material as in MB1 was used in both sessions.
In particular, all children heard the exact same voices in Session 1 and in Session 2.
From a practical point of view, this was the most straightforward solution for coordinating the experiment within the larger MB1 project.
However, familiarity effects might have influenced infants’ looking behavior. 
Infants with longer looking times in their first session might have had more opportunity to recognize familiar audio clips in their second session.
For infants with short looking times, familiar audio clips would only occur towards the end of second-session trials, thus offering infants less opportunity to recognize voices from their first session.
Therefore, inconsistent familiarity with the stimulus material in the second session across infants might have artificially lowered test-retest reliability.

# Conclusion
Following the MB1 protocol, the current study could not detect test-retest reliability in measures of infants' preference for IDS over ADS.
Subsequent analyses provided tentative evidence that stricter criteria for the inclusion of participants may enhance test-retest reliability at the cost of high drop-out rates.
Developmental studies relying on stable individual differences between their participants need to consider the underlying reliability of their measures, and we recommend a broader assessment of test-retest reliability in infant research.

\newpage

# References
```{r create_r-references}
r_refs(file = "r-references.bib")
```

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id = "refs"></div>
\endgroup
